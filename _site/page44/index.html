<!DOCTYPE html>
<html lang="en">

<head>
  <meta charset="UTF-8">
  <title>Biologist's bioinformatics notes</title>
  <meta name="viewport" content="width=device-width, initial-scale=1.0">
  <script src="/js/jquery.min.js"></script>
  <script src="/js/bootstrap.min.js"></script>
  <link href="/css/bootstrap.min.css" rel="stylesheet" type="text/css">
  <link href="/css/theme.css" rel="stylesheet" type="text/css">
  <link href="/css/syntax.css" rel="stylesheet" type="text/css">
  <link rel="stylesheet" href="https://use.fontawesome.com/releases/v5.6.3/css/all.css" integrity="sha384-UHRtZLI+pbxtHCWp1t77Bi1L4ZtiqrqD80Kn4Z8NTSRyMA2Fd33n5dQ8lWUE00s/" crossorigin="anonymous">
  <meta name="google-site-verification" content="fhL4tu7YrFAnIGAUl7DqfxgyLuyY6vE5h8o6fUwzoJM" />
</head>

<body>
  <nav class="navbar-fixed-top bg-primary">
    <span class="navbar-brand">Bioinformatics notes from a biologist</span>
    <ul class="nav navbar-nav">
      <li class="active"><a href="/"><i class="fas fa-home fa-2x"></i> Home</a></li>
      <li class="active"><a href="/archive.html"><i class="fas fa-archive fa-2x"></i> Archive</a></li>
    </ul>
  </nav>
</body>


<div class="container-fluid">
    <div class="row">
        <div class="col-md-3 hidden-xs">
            <div class=well>
  <div class="sidebar">
    16 January 2021
  </div>
  <div class="sidebar">
    <h1>Recent Posts</h1>
    <ul>
        
          <li><a href="/dplyr_column_ops">Column operations using dplyr and tidyr</a></li>
        
          <li><a href="/pheatmap_change_rowcolors">Change row font color in pheatmap conditionally</a></li>
        
          <li><a href="/ggplot">A small tutorial on ggplot2</a></li>
        
          <li><a href="/Serial-and-parallel-writing-of-fasta-files-in-R">Serial and Parallel writing of Individual fasta files in R</a></li>
        
          <li><a href="/Fasta_headers_and_back_referencing">Manipulate fasta headers using back referencing</a></li>
        
    </ul>
  </div>
  <div class="sidebar">
    <h1>Links</h1>
<ul>
  <li><a target="_blank" rel="noopener noreferrer" href="https://www.linkedin.com/in/svsk/">Linkedin</a></li>
  <li><a target="_blank" rel="noopener noreferrer" href="https://www.github.com/svsuresh">Github</a></li>
</ul>

  </div>
</div>
        </div>
        <div class="col-md-9">
          <div class="article">
            <div class="well">
                <h1><a href="/dplyr_column_ops">Jan 16, 2021 - Column operations using dplyr and tidyr</a></h1>
            <div class="post-content">
            <p>Data operations in R can be done in so many ways that it’s confusing for newbies. This note denotes simple operations using dplyr (and other packages from tidyverse). Let us do this using standard datasets available within R.</p>

<h4 id="load-libraries">Load libraries</h4>

<div class="language-r highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="n">suppressPackageStartupMessages</span><span class="p">(</span><span class="n">library</span><span class="p">(</span><span class="n">dplyr</span><span class="p">))</span><span class="w">
</span><span class="n">suppressPackageStartupMessages</span><span class="p">(</span><span class="n">library</span><span class="p">(</span><span class="n">tidyr</span><span class="p">))</span><span class="w">
</span></code></pre></div></div>
<p>Let us do some column-wise basic statistics.</p>

<h4 id="find-maximum-value-in-each-column">Find maximum value in each column</h4>

<div class="language-r highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="n">iris</span><span class="w"> </span><span class="o">%&gt;%</span><span class="w"> 
    </span><span class="n">summarise</span><span class="p">(</span><span class="n">across</span><span class="p">(</span><span class="n">where</span><span class="p">(</span><span class="n">is.numeric</span><span class="p">),</span><span class="w"> </span><span class="n">max</span><span class="p">))</span><span class="w">
</span></code></pre></div></div>

<div class="language-plaintext highlighter-rouge"><div class="highlight"><pre class="highlight"><code>##   Sepal.Length Sepal.Width Petal.Length Petal.Width
## 1          7.9         4.4          6.9         2.5
</code></pre></div></div>

<h4 id="find-maximum-value-in-each-group">Find maximum value in each group</h4>

<div class="language-r highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="n">iris</span><span class="w"> </span><span class="o">%&gt;%</span><span class="w"> 
    </span><span class="n">group_by</span><span class="p">(</span><span class="n">Species</span><span class="p">)</span><span class="w"> </span><span class="o">%&gt;%</span><span class="w"> 
    </span><span class="n">summarise</span><span class="p">(</span><span class="n">across</span><span class="p">(</span><span class="n">where</span><span class="p">(</span><span class="n">is.numeric</span><span class="p">),</span><span class="w"> </span><span class="n">max</span><span class="p">))</span><span class="w">
</span></code></pre></div></div>

<div class="language-plaintext highlighter-rouge"><div class="highlight"><pre class="highlight"><code>## `summarise()` ungrouping output (override with `.groups` argument)

## # A tibble: 3 x 5
##   Species    Sepal.Length Sepal.Width Petal.Length Petal.Width
##   &lt;fct&gt;             &lt;dbl&gt;       &lt;dbl&gt;        &lt;dbl&gt;       &lt;dbl&gt;
## 1 setosa              5.8         4.4          1.9         0.6
## 2 versicolor          7           3.4          5.1         1.8
## 3 virginica           7.9         3.8          6.9         2.5
</code></pre></div></div>

<h4 id="find-minimum-and-maximum-value-within-each-column">Find minimum and maximum value within each column</h4>

<div class="language-r highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="n">iris</span><span class="w"> </span><span class="o">%&gt;%</span><span class="w"> 
  </span><span class="n">summarise</span><span class="p">(</span><span class="n">across</span><span class="p">(</span><span class="n">where</span><span class="p">(</span><span class="n">is.numeric</span><span class="p">),</span><span class="w"> </span><span class="nf">list</span><span class="p">(</span><span class="n">min</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">min</span><span class="p">,</span><span class="w"> </span><span class="n">max</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">max</span><span class="p">)))</span><span class="w">
</span></code></pre></div></div>

<div class="language-plaintext highlighter-rouge"><div class="highlight"><pre class="highlight"><code>##   Sepal.Length_min Sepal.Length_max Sepal.Width_min Sepal.Width_max
## 1              4.3              7.9               2             4.4
##   Petal.Length_min Petal.Length_max Petal.Width_min Petal.Width_max
## 1                1              6.9             0.1             2.5
</code></pre></div></div>

<p>Now as you see, the table has grown horizontally with two functions(max and min). Imagine having 5 functions and multiple groups. Let us format this to a better table.</p>

<div class="language-r highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="n">iris</span><span class="w"> </span><span class="o">%&gt;%</span><span class="w">
    </span><span class="n">summarise</span><span class="p">(</span><span class="n">across</span><span class="p">(</span><span class="n">where</span><span class="p">(</span><span class="n">is.numeric</span><span class="p">),</span><span class="w"> </span><span class="nf">list</span><span class="p">(</span><span class="w"> </span><span class="n">min</span><span class="o">=</span><span class="n">min</span><span class="p">,</span><span class="n">max</span><span class="o">=</span><span class="n">max</span><span class="p">)))</span><span class="w"> </span><span class="o">%&gt;%</span><span class="w">
    </span><span class="n">pivot_longer</span><span class="p">(</span><span class="w">
        </span><span class="n">everything</span><span class="p">(),</span><span class="w">
        </span><span class="n">names_to</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="nf">c</span><span class="p">(</span><span class="s2">"part"</span><span class="p">,</span><span class="w"> </span><span class="s2">"stat"</span><span class="p">),</span><span class="w">
        </span><span class="n">names_sep</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="s2">"_"</span><span class="p">,</span><span class="w">
        </span><span class="n">values_to</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="s2">"measurement"</span><span class="w">
    </span><span class="p">)</span><span class="w"> </span><span class="o">%&gt;%</span><span class="w">
    </span><span class="n">pivot_wider</span><span class="p">(</span><span class="n">names_from</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="s2">"part"</span><span class="p">,</span><span class="w"> </span><span class="n">values_from</span><span class="o">=</span><span class="s2">"measurement"</span><span class="p">)</span><span class="w"> 
</span></code></pre></div></div>

<div class="language-plaintext highlighter-rouge"><div class="highlight"><pre class="highlight"><code>## # A tibble: 2 x 5
##   stat  Sepal.Length Sepal.Width Petal.Length Petal.Width
##   &lt;chr&gt;        &lt;dbl&gt;       &lt;dbl&gt;        &lt;dbl&gt;       &lt;dbl&gt;
## 1 min            4.3         2            1           0.1
## 2 max            7.9         4.4          6.9         2.5
</code></pre></div></div>

<p>There is easier way to do this outside dplyr.</p>

<div class="language-r highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="n">suppressPackageStartupMessages</span><span class="p">(</span><span class="n">library</span><span class="p">(</span><span class="n">Rfast</span><span class="p">))</span><span class="w">
</span><span class="n">data.frame</span><span class="p">(</span><span class="n">apply</span><span class="p">(</span><span class="n">iris</span><span class="p">[,</span><span class="m">-5</span><span class="p">],</span><span class="m">2</span><span class="p">,</span><span class="w"> </span><span class="n">colMinsMaxs</span><span class="p">),</span><span class="w"> </span><span class="n">row.names</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="nf">c</span><span class="p">(</span><span class="s2">"Min"</span><span class="p">,</span><span class="s2">"Max"</span><span class="p">))</span><span class="w">
</span></code></pre></div></div>

<div class="language-plaintext highlighter-rouge"><div class="highlight"><pre class="highlight"><code>##     Sepal.Length Sepal.Width Petal.Length Petal.Width
## Min          4.3         2.0          1.0         0.1
## Max          7.9         4.4          6.9         2.5
</code></pre></div></div>

<p>with Rfast package, it might be easier, but not extensible. For eg, let us say you want mean, median and sd. You cannot get all of them in the same function. However, dplyr code allows to include as many functions as you need and format as per your needs. Following is the example, for 5 functions (overall):</p>

<div class="language-r highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="n">iris</span><span class="w"> </span><span class="o">%&gt;%</span><span class="w">
    </span><span class="n">summarise</span><span class="p">(</span><span class="n">across</span><span class="p">(</span><span class="n">where</span><span class="p">(</span><span class="n">is.numeric</span><span class="p">),</span><span class="w"> </span><span class="nf">list</span><span class="p">(</span><span class="w"> </span><span class="n">Min</span><span class="o">=</span><span class="n">min</span><span class="p">,</span><span class="n">Max</span><span class="o">=</span><span class="n">max</span><span class="p">,</span><span class="w"> </span><span class="n">Mean</span><span class="o">=</span><span class="n">mean</span><span class="p">,</span><span class="w"> </span><span class="n">Median</span><span class="o">=</span><span class="n">median</span><span class="p">,</span><span class="w"> </span><span class="n">SD</span><span class="o">=</span><span class="n">sd</span><span class="p">)))</span><span class="w"> </span><span class="o">%&gt;%</span><span class="w">
    </span><span class="n">pivot_longer</span><span class="p">(</span><span class="w">
        </span><span class="n">everything</span><span class="p">(),</span><span class="w">
        </span><span class="n">names_to</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="nf">c</span><span class="p">(</span><span class="s2">"part"</span><span class="p">,</span><span class="w"> </span><span class="s2">"stat"</span><span class="p">),</span><span class="w">
        </span><span class="n">names_sep</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="s2">"_"</span><span class="p">,</span><span class="w">
        </span><span class="n">values_to</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="s2">"measurement"</span><span class="w">
    </span><span class="p">)</span><span class="w"> </span><span class="o">%&gt;%</span><span class="w">
    </span><span class="n">pivot_wider</span><span class="p">(</span><span class="n">names_from</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="s2">"part"</span><span class="p">,</span><span class="w"> </span><span class="n">values_from</span><span class="o">=</span><span class="s2">"measurement"</span><span class="p">)</span><span class="w"> 
</span></code></pre></div></div>

<div class="language-plaintext highlighter-rouge"><div class="highlight"><pre class="highlight"><code>## # A tibble: 5 x 5
##   stat   Sepal.Length Sepal.Width Petal.Length Petal.Width
##   &lt;chr&gt;         &lt;dbl&gt;       &lt;dbl&gt;        &lt;dbl&gt;       &lt;dbl&gt;
## 1 Min           4.3         2             1          0.1  
## 2 Max           7.9         4.4           6.9        2.5  
## 3 Mean          5.84        3.06          3.76       1.20 
## 4 Median        5.8         3             4.35       1.3  
## 5 SD            0.828       0.436         1.77       0.762
</code></pre></div></div>

<h4 id="find-minimum-and-maximum-value-within-each-column-for-each-plant-species">Find minimum and maximum value within each column, for each plant species:</h4>

<p>Now let us find minimum and maximum in each group (Species)</p>

<div class="language-r highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="n">iris</span><span class="w"> </span><span class="o">%&gt;%</span><span class="w">
  </span><span class="n">group_by</span><span class="p">(</span><span class="n">Species</span><span class="p">)</span><span class="w"> </span><span class="o">%&gt;%</span><span class="w"> 
  </span><span class="n">summarise</span><span class="p">(</span><span class="n">across</span><span class="p">(</span><span class="n">where</span><span class="p">(</span><span class="n">is.numeric</span><span class="p">),</span><span class="w"> </span><span class="nf">list</span><span class="p">(</span><span class="n">min</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">min</span><span class="p">,</span><span class="w"> </span><span class="n">max</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">max</span><span class="p">)))</span><span class="w">
</span></code></pre></div></div>

<div class="language-plaintext highlighter-rouge"><div class="highlight"><pre class="highlight"><code>## `summarise()` ungrouping output (override with `.groups` argument)

## # A tibble: 3 x 9
##   Species Sepal.Length_min Sepal.Length_max Sepal.Width_min Sepal.Width_max
##   &lt;fct&gt;              &lt;dbl&gt;            &lt;dbl&gt;           &lt;dbl&gt;           &lt;dbl&gt;
## 1 setosa               4.3              5.8             2.3             4.4
## 2 versic…              4.9              7               2               3.4
## 3 virgin…              4.9              7.9             2.2             3.8
## # … with 4 more variables: Petal.Length_min &lt;dbl&gt;, Petal.Length_max &lt;dbl&gt;,
## #   Petal.Width_min &lt;dbl&gt;, Petal.Width_max &lt;dbl&gt;
</code></pre></div></div>

<p>Let us format this table to a meaningful table as below:</p>

<div class="language-r highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="n">iris</span><span class="w"> </span><span class="o">%&gt;%</span><span class="w">
    </span><span class="n">group_by</span><span class="p">(</span><span class="n">Species</span><span class="p">)</span><span class="w"> </span><span class="o">%&gt;%</span><span class="w">
    </span><span class="n">summarise</span><span class="p">(</span><span class="n">across</span><span class="p">(</span><span class="n">where</span><span class="p">(</span><span class="n">is.numeric</span><span class="p">),</span><span class="w"> </span><span class="nf">list</span><span class="p">(</span><span class="n">max</span><span class="o">=</span><span class="n">max</span><span class="p">,</span><span class="w"> </span><span class="n">min</span><span class="o">=</span><span class="n">min</span><span class="p">)))</span><span class="w"> </span><span class="o">%&gt;%</span><span class="w">
    </span><span class="n">pivot_longer</span><span class="p">(</span><span class="w">
        </span><span class="o">-</span><span class="n">Species</span><span class="p">,</span><span class="w">
        </span><span class="n">names_to</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="nf">c</span><span class="p">(</span><span class="s2">"part"</span><span class="p">,</span><span class="w"> </span><span class="s2">"stat"</span><span class="p">),</span><span class="w">
        </span><span class="n">names_sep</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="s2">"_"</span><span class="p">,</span><span class="w">
        </span><span class="n">values_to</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="s2">"measurement"</span><span class="w">
    </span><span class="p">)</span><span class="w"> </span><span class="o">%&gt;%</span><span class="w">
    </span><span class="n">pivot_wider</span><span class="p">(</span><span class="n">names_from</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="s2">"part"</span><span class="p">,</span><span class="w"> </span><span class="n">values_from</span><span class="o">=</span><span class="s2">"measurement"</span><span class="p">)</span><span class="w">
</span></code></pre></div></div>

<div class="language-plaintext highlighter-rouge"><div class="highlight"><pre class="highlight"><code>## `summarise()` ungrouping output (override with `.groups` argument)

## # A tibble: 6 x 6
##   Species    stat  Sepal.Length Sepal.Width Petal.Length Petal.Width
##   &lt;fct&gt;      &lt;chr&gt;        &lt;dbl&gt;       &lt;dbl&gt;        &lt;dbl&gt;       &lt;dbl&gt;
## 1 setosa     max            5.8         4.4          1.9         0.6
## 2 setosa     min            4.3         2.3          1           0.1
## 3 versicolor max            7           3.4          5.1         1.8
## 4 versicolor min            4.9         2            3           1  
## 5 virginica  max            7.9         3.8          6.9         2.5
## 6 virginica  min            4.9         2.2          4.5         1.4
</code></pre></div></div>

<p>We can further beautify this table with kable package.</p>

            </div>
          </div>
          <div class="pagination">
              
              
                <a class="btn btn-default" href="/pheatmap_change_rowcolors" class="previous">Older Post</a>
              
          </div>
        </div>
    </div>
</div>

<body>
<html>	
<div class="container-fluid">
    <div class="row-fluid">
        <div class="span12 footer navbar-inverse navbar-fixed-bottom">
            <p class="copyright">&copy;2021 Biologist's bioinformatics notes. Powered by <a href="http://jekyllrb.com">Jekyll</a>, theme by <a href="https://github.com/scotte/jekyll-clean">Scott Emmons</a>
            under
            <a href="http://creativecommons.org/licenses/by/4.0/">Creative Commons Attribution</a></p>
        </div>
    </div>
</div>

</body>
</html>



<div class="pagination">
  
      
        <a class="btn btn-default" href="/page43" class="previous">Newer</a>
      
  
</div>
