<!DOCTYPE html>
<html lang="en">

<head>
  <meta charset="UTF-8">
  <title>Biologist's bioinformatics notes</title>
  <meta name="viewport" content="width=device-width, initial-scale=1.0">
  <script src="/js/jquery.min.js"></script>
  <script src="/js/bootstrap.min.js"></script>
  <link href="/css/bootstrap.min.css" rel="stylesheet" type="text/css">
  <link href="/css/theme.css" rel="stylesheet" type="text/css">
  <link href="/css/syntax.css" rel="stylesheet" type="text/css">
  <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/4.7.0/css/font-awesome.min.css">
</head>

<body>
  <nav class="navbar-fixed-top bg-primary">
    <span class="navbar-brand">Bioinformatics notes from a biologist</span>
    <ul class="nav navbar-nav">
      <li class="active"><a href="/"><i class="fa fa-home fa-lg"></i> Home</a></li>
      <li class="active"><a href="/archive.html"><i class="fa fa-archive"></i> Archive</a></li>
    </ul>
  </nav>
</body>

<div class="container-fluid">
    <div class="row">
        <div class="col-md-3 hidden-xs">
            <div class=well>
  <div class="sidebar">
    06 October 2020
  </div>
  <div class="sidebar">
    <h1>Recent Posts</h1>
    <ul>
        
          <li><a href="/python_pie_05102020">Percentage pie chart with python 3</a></li>
        
          <li><a href="/ggplot_pie">Percentage pie chart in R</a></li>
        
          <li><a href="/rename-files-from-file">Batch rename files from a file</a></li>
        
          <li><a href="/one-liners-in-bioinformatics">One liners in bioinformatics (ever updating)</a></li>
        
          <li><a href="/remove-named-columns-from-several-files">Remove named columns from several files</a></li>
        
    </ul>
  </div>
  <div class="sidebar">
    <h1>Links</h1>
<ul>
  <li><a target="_blank" rel="noopener noreferrer" href="https://www.linkedin.com/in/svsk/">Linkedin</a></li>
  <li><a target="_blank" rel="noopener noreferrer" href="https://www.github.com/svsuresh">Github</a></li>
</ul>

  </div>
</div>
        </div>
        <div class="col-md-9">
          <div class="article">
            <div class="well">
                <h1><a href="/retain-sequences-based-on-partial-match">Jul 27, 2020 - Retain sequences based on partial match of headers</a></h1>
            <div class="post-content">
            <div style="text-align: justify;">
One of the user issues, I came across, is to retain a single sequence for each group. User didn't mention the length or other criteria. However, headers have lot more information than group it self.&nbsp;</div>
<div style="text-align: justify;">
Example fasta file is below:</div>
<div style="text-align: justify;">
====================================================================== </div>
<div style="text-align: justify;">
&gt;group_1_samplenameA</div>
<div style="text-align: justify;">
CGCTTCAACGGAATGGATCTACGTTACAGCCTGCATAAAGAAAACGGAGTTGCCGAGGACG</div>
<div style="text-align: justify;">
AAAGCGACTTTAGGTTCTGTCCGTTGTCTTTGGCGGAAA</div>
<div style="text-align: justify;">
&gt;group_2_samplenameB</div>
<div style="text-align: justify;">
AAATTCAACGGAATGGATCTACGTTACAGCCTGCATAAAGAAAACGGAGTTGCCGAGGACG</div>
<div style="text-align: justify;">
AAAGCGACTTTAGGTTCTGTCCGTTGTCTTTGGCGGAAG</div>
<div style="text-align: justify;">
&gt;group_3_samplenameC</div>
<div style="text-align: justify;">
CGCTTCAACGGAATGGATCTACGTTACAGCCTGCATAAAGAAAACGGAGTTGCCGAGGACG</div>
<div style="text-align: justify;">
AAAGCGACTTTAGGTTCTGTCCGTTGTCTTTGGCGGAAA</div>
<div style="text-align: justify;">
&gt;group_3_samplenameD</div>
<div style="text-align: justify;">
CGCTTCAACGGAATGGATCTACGTTACAGCCTGCATAAAGAAAACGGAGTTGCCGAGGACGA</div>
<div style="text-align: justify;">
=======================================================================</div>
<div style="text-align: justify;">
In the above example, fasta headers have group information plus other information. User wants to retain one sequence per group. Let us do that with seqkit.</div>
<div style="text-align: justify;">
======================================================================</div>
<div style="text-align: justify;">
$ seqkit --quiet --id-regexp '(^\w+_[0-9])' rmdup test.fa</div>
<div style="text-align: justify;">
<br /></div>
<div style="text-align: justify;">
&gt;group_1_samplenameA</div>
<div style="text-align: justify;">
CGCTTCAACGGAATGGATCTACGTTACAGCCTGCATAAAGAAAACGGAGTTGCCGAGGAC</div>
<div style="text-align: justify;">
GAAAGCGACTTTAGGTTCTGTCCGTTGTCTTTGGCGGAAA</div>
<div style="text-align: justify;">
&gt;group_2_samplenameB</div>
<div style="text-align: justify;">
AAATTCAACGGAATGGATCTACGTTACAGCCTGCATAAAGAAAACGGAGTTGCCGAGGAC</div>
<div style="text-align: justify;">
GAAAGCGACTTTAGGTTCTGTCCGTTGTCTTTGGCGGAAG</div>
<div style="text-align: justify;">
&gt;group_3_samplenameC</div>
<div style="text-align: justify;">
CGCTTCAACGGAATGGATCTACGTTACAGCCTGCATAAAGAAAACGGAGTTGCCGAGGAC</div>
<div style="text-align: justify;">
GAAAGCGACTTTAGGTTCTGTCCGTTGTCTTTGGCGGAAA</div>
<div style="text-align: justify;">
=======================================================================</div>
<div style="text-align: justify;">
Explanation:</div>
<ol style="text-align: justify;">
<li style="text-align: justify;">--quiet - do not print standard error/output on the screen</li>
<li style="text-align: justify;">--id-regexp - regex to be used in matching headers. By default, rmdup matches on headers in seqkit</li>
<li style="text-align: justify;">^\w+_[0-9]- Regex for starting with a word followed by _, followed by a single digit. This matches group_1, group_2, group_3 etc</li>
</ol>

            </div>
          </div>
          <div class="pagination">
              
                <a class="btn btn-default" href="/uncount-function-in-r" class="next">Newer Post</a>
              
              
                <a class="btn btn-default" href="/partial-renaming-of-fasta-headers" class="previous">Older Post</a>
              
          </div>
        </div>
    </div>
</div>

<body>
<html>	
<div class="container-fluid">
    <div class="row-fluid">
        <div class="span12 footer navbar-inverse navbar-fixed-bottom">
            <p class="copyright">&copy;2020 Biologist's bioinformatics notes. Powered by <a href="http://jekyllrb.com">Jekyll</a>, theme by <a href="https://github.com/scotte/jekyll-clean">Scott Emmons</a>
            under
            <a href="http://creativecommons.org/licenses/by/4.0/">Creative Commons Attribution</a></p>
        </div>
    </div>
</div>

</body>
</html>

